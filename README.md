# Repeat NextFlow Pipeline

This is a NextFlow pipeline designed to find and annotate repeats (GSoC project). The pipeline consists of multiple processes: `buildDatabase`, `repeatmodeler`, `repeatmasker`, `dust`, and `trf`. Additionally, Singularity support has been added to containerize the required tools.

## Requirements

To run this pipeline, make sure you have the following requirements installed:

- [Java Development Kit (JDK)](https://www.oracle.com/java/technologies/javase-jdk11-downloads.html) version 11 or above
- [Nextflow](https://www.nextflow.io/) version 21.04.3 or above
- [Singularity](https://sylabs.io/singularity/) version 3.7.0 or above (for containerization)

## Installation

1. Install Java Development Kit (JDK) version 11 or above by following the installation instructions provided by the JDK provider.
    
2. Install Nextflow by following the instructions provided in the [Nextflow documentation](https://www.nextflow.io/docs/latest/getstarted.html).
    
3. Install Singularity by following the instructions provided in the [Singularity documentation](https://sylabs.io/guides/3.7/user-guide/quick_start.html).
    
4. Pull the Singularity image for RepeatModeler and RepeatMasker using the following command:
    
    `singularity pull docker://dfam/tetools:latest`    

## Usage

1. Clone this repository to your local machine or download the files directly.
    
2. Open a terminal or command prompt and navigate to the cloned/downloaded repository.
    `cd repeat_nf/`
    
3. Run the pipeline using the following command:
    
    ```
   nextflow -C nextflow.config run repeat_pipeline.nf --input <fastafile> --engine <engine>
    ```
    
4. The pipeline will execute the processes in the following order:
    
    - `buildDatabase`: This process takes a FASTA file as input and builds a repeat database using RepeatModeler's `BuildDatabase` tool inside the Singularity container. The repeat database files will be stored in the output directory `${fastaFile}_database/`.
        
    - `repeatmodeler`: This process uses the repeat database generated in the previous step and the original FASTA file as input to run RepeatModeler's `RepeatModeler` tool inside the Singularity container. The repeat annotations and a file containing the repeat families will be stored in the `repeatmodeler_output/` directory.
        
    - `repeatmasker`: This process takes the repeat families file generated by `repeatmodeler` and the original FASTA file as input. This process also takes engine as input which will be used for repeatmasking. It uses RepeatMasker to annotate repeats in the FASTA file and generates a GFF file in the `repeatmasker_output/` directory.
        
    - `dust`: This process performs dust masking on the original FASTA file using the `dustmasker` tool inside the Singularity container. The output will be stored in the `dust_output/` directory.
        
    - `trf`: This process executes Tandem Repeat Finder (`trf`) on the original FASTA file inside the Singularity container and generates output in the `trf_output/` directory.
        
5. The results will be generated in the specified output directories or the default output directories if not provided.
